%-----------------------------------------------------------------------------%
%                                                                             %
%    K A P I T E L   2                                                        %
%                                                                             %
%-----------------------------------------------------------------------------%

\chapter{Background: Optimal Bipedal Locomotion}\label{c2}
The second chapter provides the reader with fundamentals on the mathematical modeling of legged robots, outlines how motion generation can be formulated as optimization problem and introduces the class of algorithms used within this thesis. 

\section{Modeling and Control of Legged Robots}
\subsection{Terminology}
\subsubsection{Three Dimensions of Motion}
\subsubsection{Gait Analysis (Double Support, Gait Phases ..)}
\subsection{Dynamics}
\subsection{Stability Analysis}
\subsection{Motion Generation}
\subsection{Motion Control}
\subsubsection{Kinematic Control (High-gain joint position trajectory tracking)}
\subsubsection{Impedance Control with Joint Space Inverse Dynamics (Low-gain joint control with model compensation)}
\subsubsection{Task Space Inverse Dynamics Control (Directly regulating in «task space»)}
\subsubsection{Virtual Model Control (Dynamic control of a quasistatic system)}
\subsection{Efficient Walking}

\section{Trajectory Optimization}

\section{Differential Dynamic Programming (DDP)}
This section describes the basics of DDP, which is an \gls{OC} algorithm that belongs to the \gls{TO} class. The algorithm was introduced in 1966 by \citeauthor{MAYNE1966} \citep{MAYNE1966}.
\subsection{Local Dynamic Programming}
The discrete time dynamics of a system can be modeled as a generic function $\myM{f}$
\begin{equation}\label{eqn:discreteDynamics}
\myM{x}_{i+1}=\myM{f}(\myM{x}_i,\myM{u}_i), 
\end{equation}
which describes the evolution of the state $\myM{x}\in \myM{R}^n$ from time $i$ to $i+1$, given the control $u\in \myM{R}^m$. A valid trajectory $\{\myM{X}, \myM{U}\}$ is a sequence of states $\myM{X}=\{\myM{x}_0, \myM{x}_1, ..., \myM{x}_N\}$ and control inputs $\myM{U}=\{\myM{u}_0, \myM{u}_1, ..., \myM{u}_N\}$ satisfying \cref{eqn:discreteDynamics}.
\begin{equation}\label{eqn:totalCost}
J(\myM{x}_0, \myM{U})=\sum_{i=0}^{N-1}l(\myM{x}_i,\myM{u}_i)+l_f(\myM{x}_N)
\end{equation}
\begin{equation}\label{eqn:minControl}
\myM{U}^*=\argmin_U J(\myM{x}_0, \myM{U})
\end{equation}
\begin{equation}\label{costToGo}
J_i(\myM{x}, \myM{U}_i)=\sum_{j=i}^{N-1}l(\myM{x}_j,\myM{u}_j)+l_f(\myM{x}_N)
\end{equation}
\begin{equation}\label{eqn:value}
V_i(\myM{x})=\min_{\myM{U}_i}J_i(\myM{x}, \myM{U}_i)
\end{equation}
\begin{equation}
V(\myM{x})=\min_{\myM{u}}[l(\myM{x}, \myM{u})+V'(\myM{f}(\myM{x},\myM{u}))]
\end{equation}
\subsection{Quadratic Approximation}
\begin{equation}\label{eqn:Q}
Q(\dx,\du)=l(\bx+\dx,\bu+\du)+V'(\bfun(\bx+\dx,\bu+\du))
\end{equation}
\begin{subequations}\label{eqn:dQ}
\begin{align}
Q_{\bx} &= l_{\bx}+\bfun_{\bx}^T V_{\bx}^\prime \\
Q_{\bu} &= l_{\bu}+\bfun_{\bu}^T V_{\bx}^\prime \\
Q_{\bx\bx} &= l_{\bx\bx}+\bfun_{\bx}^T V_{\bx\bx}^\prime\bfun_{\bx}+V_{\bx}^\prime\cdot\bfun_{\bx\bx}  \\
Q_{\bu\bx} &= l_{\bu\bx}+\bfun_{\bu}^T V_{\bx\bx}^\prime\bfun_{\bx}+V_{\bx}^\prime\cdot\bfun_{\bu\bx} \\
Q_{\bu\bu} &= l_{\bu\bu}+\bfun_{\bu}^T V_{\bx\bx}^\prime\bfun_{\bu}+V_{\bx}^\prime\cdot\bfun_{\bu\bu} 
\end{align}
\end{subequations}
\begin{equation}
\du^*(\dx)=\argmin_{\du}Q(\dx,\du)=\myM{k}+\myM{K}\
\end{equation}
\begin{equation}
\myM{k}=-Q_{\bu\bu}^{-1}Q_{\bu}\quad and \quad \myM{K}=-Q_{\bu\bu}^{-1}Q_{\bu\bx}
\end{equation}
\begin{subequations}\label{eqn:quadraticV}
\begin{align}
 \Delta V &= -\dfrac{1}{2}\myM{k}^TQ_{\bu\bu}\myM{k} \\
 V_{\bx} &= Q_{\bx}-\myM{K}^TQ_{\bu\bu}\myM{k} \\
 V_{\bx\bx} &= Q_{\bx\bx}-\myM{K}^TQ_{\bu\bu}\myM{\myM{K}}
\end{align}
\end{subequations}



\subsection{Line Search and Regularization}

\section{DDP With Constrained Robot Dynamics}
\subsection{Handling Tasks}
\subsection{Contact Dynamics}
\subsection{Karush-Kuhn-Tucker (KKT) Conditions}
\subsection{KKT-Based DDP Algorithm}
Rigid contacts can be formulated as holonomic scleronomic constraints to the robot dynamics. 

\section{The RH5 Humanoid Robot}












